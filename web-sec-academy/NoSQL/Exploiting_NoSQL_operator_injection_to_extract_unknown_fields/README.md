## Exploiting NoSQL operator injection to extract unknown fields

1. BAC bằng operator injection với user carlos
![image](https://github.com/user-attachments/assets/8f6fedde-0f24-4a2d-beb7-56a89f601dac)

2. Nhận thấy tài khoản này đang bị lock, yêu cầu phải reset password.
3. Chèn toán tử where để check điều kiện, nhận thấy where = 1 thì response là như khi nhập đúng tk mk (Ở đây là trả về account locked), còn where = 0 thì invalid user pw
![image](https://github.com/user-attachments/assets/b16877be-2861-47ce-8bec-64272423f4e4)

4. Trong docs có hướng dẫn cách fuzz field name, sử dụng Object.keys (test thêm ở trang này [ObjectKey](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys) )
- Object.keys({obj}) trong js trả về một array các key-values
- Ta sẽ tìm char by char bằng intruder sau:
![image](https://github.com/user-attachments/assets/75a98c3d-beda-4f68-aaf5-b8eed21e5f9c)

5. Nhận được trường newPwdTkn, tiếp theo tìm giá trị của trường đấy bằng intruder sau:
![image](https://github.com/user-attachments/assets/27651457-6dfe-4d0d-944d-578405306360)

6. Nhận được token 
![image](https://github.com/user-attachments/assets/bb1277e1-4744-4570-a456-86d3dc9524a0)
![image](https://github.com/user-attachments/assets/a9923369-b633-470e-9501-c7716be1e447)

7. Giờ tim f endpoint đổi password, nó chính là GET request ``forget-password?newPwdTkn=TOKEN`` và được trả về trang đổi mk -> thành công.
