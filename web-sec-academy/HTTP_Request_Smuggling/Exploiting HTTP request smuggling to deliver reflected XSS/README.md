## Exploiting HTTP request smuggling to deliver reflected XSS

1. Khi thử submit một comment nhận thấy trong request gửi đi có param `userAgent`. Được gửi đi với giá trị có trong form, có lẽ được lấy từ header `User-Agent`.

2. Khi gửi một request với header `User-Agent: a"/><script>alert(1)</script>` nhận thấy nó reflect trong form.

![image](https://user-images.githubusercontent.com/80744099/227454173-f388dd69-950c-4f1d-bdc2-20666a50583f.png)

3. Craft smuggling request với header `User-Agent: a"/><script>alert(1)</script>` được cố định. Để sau khi gửi request này thì request tiếp theo sẽ được gán thêm phần payload tới bài post với header useragent được đặt sẵn payload xss. 

![image](https://user-images.githubusercontent.com/80744099/227454811-7b13289c-ffa4-4b4a-a048-62f5a2d2b75a.png)

4. Nếu ta nhanh tay gửi request này 2 lần thì reqeust thứ 2 sẽ có dạng:
```
GET /post/?postId=5 HTTP/1.1
User-Agent: a"/><script>alert(1)</script>
Content-Length: 5

x=1
...
```

-> Làm chính máy của ta bị đầu độc.

![image](https://user-images.githubusercontent.com/80744099/227455144-2e49643e-b30c-4a22-871b-1e22378f2eab.png)

5. Gửi smuggling request rồi chờ cho victim access vào.
